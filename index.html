<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simple Runner</title>
<style>
body {
  margin: 0;
  overflow: hidden;
  background: #87ceeb;
  font-family: sans-serif;
}

#game {
  position: relative;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
  background: linear-gradient(to top, #87ceeb 0%, #a0d8f1 100%);
}

#player {
  position: absolute;
  bottom: 50px;
  left: 50px;
  width: 50px;
  height: 50px;
  background: #ff3333;
  border-radius: 5px;
}

.obstacle {
  position: absolute;
  bottom: 50px;
  width: 50px;
  height: 50px;
  background: #333;
}

#score {
  position: absolute;
  top: 10px;
  left: 10px;
  color: white;
  font-size: 24px;
}

#message {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  color: red;
  font-size: 36px;
  display: none;
  text-align: center;
}
</style>
</head>
<body>
<div id="game">
  <div id="player"></div>
  <div id="score">0</div>
  <div id="message">Game Over<br>Appuyez pour recommencer</div>
</div>

<script>
const game = document.getElementById('game');
const player = document.getElementById('player');
const scoreEl = document.getElementById('score');
const messageEl = document.getElementById('message');

let obstacles = [];
let score = 0;
let gameOverFlag = false;
let jump = false;
let jumpHeight = 0;
const jumpSpeed = 8;
const gravity = 4;

// --- Créer obstacle ---
function createObstacle() {
  const obs = document.createElement('div');
  obs.classList.add('obstacle');
  obs.style.left = window.innerWidth + 'px';
  game.appendChild(obs);
  obstacles.push(obs);
}

// --- Boucle de jeu ---
function gameLoop() {
  if(gameOverFlag) return;

  // Gestion saut
  if(jump){
    jumpHeight += jumpSpeed;
    if(jumpHeight >= 150) jump = false;
  } else if(jumpHeight > 0){
    jumpHeight -= gravity;
    if(jumpHeight < 0) jumpHeight = 0;
  }
  player.style.bottom = 50 + jumpHeight + 'px';

  // Déplacer obstacles
  for(let i = obstacles.length -1; i >=0; i--){
    const obs = obstacles[i];
    let x = parseFloat(obs.style.left);
    x -= 8; // vitesse
    obs.style.left = x + 'px';

    // Collision
    const playerRect = player.getBoundingClientRect();
    const obsRect = obs.getBoundingClientRect();
    if(playerRect.left < obsRect.right &&
       playerRect.right > obsRect.left &&
       playerRect.bottom > obsRect.top &&
       playerRect.top < obsRect.bottom){
      gameOver();
    }

    // Supprimer obstacles hors écran
    if(x + 50 < 0){
      obs.remove();
      obstacles.splice(i,1);
      score++;
      scoreEl.innerText = score;
    }
  }

  requestAnimationFrame(gameLoop);
}

// --- Game Over ---
function gameOver(){
  gameOverFlag = true;
  messageEl.style.display = 'block';
}

// --- Redémarrer ---
function restartGame(){
  obstacles.forEach(o => o.remove());
  obstacles = [];
  score = 0;
  scoreEl.innerText = score;
  jumpHeight = 0;
  jump = false;
  player.style.bottom = '50px';
  messageEl.style.display = 'none';
  gameOverFlag = false;
}

// --- Contrôles ---
document.addEventListener('keydown', e => {
  if(e.code === 'Space'){
    if(!jump && !gameOverFlag) jump = true;
  }
});

document.addEventListener('click', () => {
  if(gameOverFlag){
    restartGame();
  } else if(!jump){
    jump = true;
  }
});

document.addEventListener('touchstart', e => {
  e.preventDefault();
  if(gameOverFlag){
    restartGame();
  } else if(!jump){
    jump = true;
  }
});

// --- Génération obstacles ---
setInterval(() => {
  if(!gameOverFlag) createObstacle();
}, 2000);

// --- Lancer le jeu ---
gameLoop();
</script>
</body>
</html>